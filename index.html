<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="./index.css">
    <title>Pets vs Skeletons</title>
  </head>
  <body>
    <canvas id="canvas" width="480" height="360"></canvas>

    <script type="text/javascript">
      window.requestAnimationFrame(step);

      let canvas = document.getElementById("canvas");
      let ctx = canvas.getContext("2d");
      let image = new Image();

      image.src = "images/skeleton_monster.png";
      image.onload = function() {
        init();
      }
      const scale = 1.25;
      const width = 64;
      const height = 64;
      const scaledWidth = scale * width;
      const scaledHeight = scale * height;

      function drawFrame(frameX, frameY, canvasX, canvasY) {
        ctx.drawImage(image, frameX * width, frameY * height, width, height,
          canvasX, canvasY, scaledWidth, scaledHeight);
      }

      const stepCycle = [0, 1, 2, 3];
      const deathCycle = [0, 1, 2, 3, 4, 5, 6, 7]
      let currStepIndex = 0;
      let currDeathIndex = 0;
      let frameCount = 0;

      function step() {
        frameCount++;
        if (frameCount < 20) {
          window.requestAnimationFrame(step);
          return;
        }
        frameCount = 0;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawFrame(stepCycle[currStepIndex], 1, 0, 0);
        drawFrame(stepCycle[currStepIndex], 2, 0, 64);
        drawFrame(deathCycle[currDeathIndex], 3, 0, 128);
        drawFrame(stepCycle[currStepIndex], 0, 0, 192);
        drawFrame(deathCycle[currDeathIndex], 5, 0, 256);
        currStepIndex++;
        currDeathIndex++;
        if (currStepIndex >= stepCycle.length) {
          currStepIndex = 0;
        }
        if (currDeathIndex >= deathCycle.length) {
          currDeathIndex = 0;
        }
        window.requestAnimationFrame(step);
      }

      function init() {
        window.requestAnimationFrame(step)
      }

    </script>
  </body>
</html>
